## 3 Layer

영상: [[따라學IT] 04. 실제로 컴퓨터끼리는 IP주소를 사용해 데이터를 주고받는다](https://youtu.be/s5kIGnaNFvM?list=PL0d8NnikouEWcF1jJueLdjRIC4HsUlULi)

### 3계층의 기능

- 서로 다른 LAN 네트워크 대역을 연결
- 라우터와 같은 3계층 장비를 사용
- 발신에서 착신까지의 패킷의 경로를 제어



### 3계층에서 쓰는 주소

![image-20220213164345347](4장-IP-주소.assets/image-20220213164345347.png)

### 3계층 프로토콜

#### ARP

![image-20220213164507776](4장-IP-주소.assets/image-20220213164507776.png)

#### IPv4

![image-20220213164524945](4장-IP-주소.assets/image-20220213164524945.png)

#### ICMP

![image-20220213164610484](4장-IP-주소.assets/image-20220213164610484.png)



### 일반적인 IP 주소 = IPv4

- 10진수, 4바이트 = 32비트
- 8비트로는 0부터 255(11111111)까지 표현이 가능한데, IP주소의 경우 하나의 필드인 3자리는 최대 255까지 가능하다.
- 192.168.0.189 (각 3자리는 0~255 사이의 10진수)

#### Classful 주소

![image-20220213164908556](4장-IP-주소.assets/image-20220213164908556.png)

![image-20220213165304590](/Users/euijinpang/[git] cs/네트워크/4장-IP-주소.assets/image-20220213165304590.png)

![image-20220213165345464](/Users/euijinpang/[git] cs/네트워크/4장-IP-주소.assets/image-20220213165345464.png)

![image-20220213165240194](4장-IP-주소.assets/image-20220213165240194.png)

![image-20220213165810911](4장-IP-주소.assets/image-20220213165810911.png)

- 클래스가 뒤로 갈수록 네트워크 대역은 점점 줄고, 그 안에 속해있는 컴퓨터를 구분하는 갯수는 점점 늘어난다.
- 일반적으로는 C 클래스 이상을 사용한다. 

- A, B 클래스의 경우 IP 주소가 낭비된다.



#### Classless 주소

- 원하는 위치에서 잘라서 쓴다.
- 서브넷마스크
  - 클래스풀한 네트워크 대역을 나눠주는데 사용하는 값

![image-20220213170004960](4장-IP-주소.assets/image-20220213170004960.png)

![image-20220213170137302](4장-IP-주소.assets/image-20220213170137302.png)

![image-20220213170317413](4장-IP-주소.assets/image-20220213170317413.png)



#### 사설 IP & 공인 IP

- 사설 IP에서 다른 네트워크로 갈 때는 공인 IP 로 바꿔서 나간다.
- ipconfig 의 주소는 사설 ip, 네이버 검색 ip 는 공인 ip
- 사설 ip를 공인 ip 로 바꾸어주는 것이 `NAT` 기술이다.

![image-20220213171644717](4장-IP-주소.assets/image-20220213171644717.png)

![image-20220213170447128](4장-IP-주소.assets/image-20220213170447128.png)



- 외부에서는 사설 IP 대역이 보이지 않는다.
- NAT Table 에 나갈때 기록하고, 들어올 때 확인한다.
- 만약 나간적이 없는데, 들어온 게 있다면? 공유기가 받고 끝난다.
- 서버는 사설 IP가 아닌 공인 IP 를 사용한다. 왜? 나간 적이 없어도 밖에서 안으로 들어와야하기 때문에. 



![image-20220213171303698](4장-IP-주소.assets/image-20220213171303698.png)



### 특수한 IP 주소

#### 0.0.0.0/0

- 나머지 모든 IP

![image-20220213171710429](4장-IP-주소.assets/image-20220213171710429.png)

#### 127.0.0.1

![image-20220213171739123](4장-IP-주소.assets/image-20220213171739123.png)

#### 공유기 ip

- WAN + LAN / LAN / LAN / LAN
- WAN 에는 공인 IP 가 할당된다.
- 기본 게이트웨이에는 가장 작거나 높은 IP 를 쓴다.

![image-20220213171813035](4장-IP-주소.assets/image-20220213171813035.png)

![image-20220213171938160](4장-IP-주소.assets/image-20220213171938160.png)



### 내 IP 주소 = 사설 ip

![image-20220213172123979](4장-IP-주소.assets/image-20220213172123979-4740485.png)

### 네이버가 알고있는 내 IP 주소 = 공인 ip

![image-20220213172148022](4장-IP-주소.assets/image-20220213172148022.png)



